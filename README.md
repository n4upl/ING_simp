# Simple tool to handle SIMP reports via ING Bank API.

## How to generate new ING Certificate:
- download the certificate generator app from: https://ingbusiness.pl/atms/GeneratorCert/INGCertGenerator.jar

## start INGCertGenerator.jar using Oracle JRE8:
```
java -jar INGCertGenerator.jar 
```

1) add klient id, integer. eg. 37331
2) generate new CSR turn it into certificate.
2.1) generate CSR with INGCertGenerator.jar - krok 2
![image](https://github.com/n4upl/ING_simp/assets/10530333/03a3563b-c7ec-4d80-acca-f8de11615c96)

2.2) sign CSR by ING Bank: paste CSR into ING bank transaction system:
https://ingbusiness.pl/gib/login -> Administracja i narzedzia -> administracja -> Zarzadzanie WebService -> Klienci WebService -> Certyfikaty -> Dodaj Certyfikat -> Paste -> Dodaj -> Pobierz (certyfikat transferowy zapisz na dysku). Save transfer certficate `37331.cer` to the disk.

3) Import certificates 
3.1) import from bank server: Pobierz z serwera
3.2) import transfer certficate (previously downloaded signed cert generated by bank at step 2.2)
  
![image](https://github.com/n4upl/ING_simp/assets/10530333/789fef1b-c4b0-471d-b5f2-6bfe249a6052)

4) test connectivity
5) Save the keystore with generated cert and trustchain.
Due to app limitation only JKS format of the keystore can be used to save file (app gives error while saving PKCS12 and PEM).
 Please be aware to choose strong password for the keystore.

Save generated keystore (`37331.jks`) to the disk.

![image](https://github.com/n4upl/ING_simp/assets/10530333/a3936bc9-07b0-496e-8d6c-449ef604519c)


## Convert the keystore to .pem format. 
The `simp.py` app can undestard certiificates pem format only. Therefore, generated JKS keystore has to be converted to PEM format.
1) Please download (protecle)[http://portecle.sourceforge.net/] software from https://netcologne.dl.sourceforge.net/project/portecle/v1.11/portecle-1.11.zip
2) unzip it and run with jdk17:

```
unzip portecle-1.11.zip
cd portecle-1.11
java -jar portecle.jar
```

3) Open 37331.jks : portecle.jar -> File -> Open Keystore File and give the keystore password 
4) Right click over your `clienttransport` entry and select export like on the image below selecting "Private Key and Certificate" and PEM Encoded format.

![image](https://github.com/n4upl/ING_simp/assets/10530333/f095ddc6-1dce-4f24-a00d-9183afd470d5)

5) copy generated `37331.pem` file to your simp.py folder and run `./simp.py get` 
